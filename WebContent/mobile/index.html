<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>走势图</title>
<script src="${BASE_PATH}js/jquery.js"></script>
<style>
body{font-size:13px;}
.titleTable td,.titleTable th{border-top:1px solid #f1f1f1;border-left:1px solid #f1f1f1;}
#zoushiPuture td{border-top:1px solid #f1f1f1;border-left:1px solid #f1f1f1; height:30px;}

button{margin-left:15px; cursor:pointer;}
.numStrClass{float:left; width:32px; height:32px; background: url(../images/flbks2.png) left center no-repeat;}
</style>
</head>

<body style="background:#FAFAFA;">
<div style="height:106px; margin:20px auto;">
	<div style="float:left; width:80px; height:80px; overflow:hidden; border-radius:40px;">
		<img src="${BASE_PATH}images/feilvbin.png" style="width:80px; height:80px;"/>
	</div>
	<div style="float:left; width:476px; margin-left:20px;">
		<div style="font-size:13px; color:#333;">
			<p style="float:left; padding:0px; margin:0px;">菲律宾快3第<span style="font-weight: 700; color: #e73f3f;">${Llog.qiNum}</span>期开奖号码</p>
			<div style="clear:both;"></div>
		</div>
		<div style="border:1px solid #e5e5e5;  padding: 13px 0 13px 13px;  background: #fff;  border-radius: 3px;  overflow: hidden; margin-top: 13px;">
			<div class="numStrClass" style="float:left; background-position: ${Llog.firstNum}px center;"></div>
			<div class="numStrClass" style="float:left; background-position: ${Llog.secondNum}px center; margin-left:5px;"></div>
			<div class="numStrClass" style="float:left; background-position: ${Llog.threeNum}px center; margin-left:5px;"></div>
			<div style="clear:both;"></div>
		</div>
	</div>
	<div style="clear:both;"></div>
</div>
<div style="margin:20px auto 10px auto; padding-top:20px; border-top: 1px solid #e5e5e5;">
	<a href="${BASE_PATH}home.html" target="_self" style="float: left; height: 33px; line-height: 33px; color:#666; text-decoration:none; padding: 0 16px; border-radius: 3px; border: 1px solid #e5e5e5; margin-right: 10px; background: #fff;">历史开奖</a>
	<a href="${BASE_PATH}home/resHtml.html" target="_self" style="float: left; height: 33px; line-height: 33px; padding: 0 16px; color:#666; text-decoration:none; border-radius: 3px; border: 1px solid #e5e5e5; margin-right: 10px; background: #fff;">开奖走势</a>
	<div style="clear:both;"></div>
</div>
<div id="zoushiBox" style="width: 940px;margin:0px auto; margin-top:15px; display:block;">
<table class="titleTable" height="61" border="0" cellpadding="0" cellspacing="0" style="text-align:center; border-right:1px solid #f1f1f1;">
  <tr>
    <td style="width:100px;" rowspan="2" scope="col">期号</td>
    <td style="width:116px;" colspan="3" rowspan="2" scope="col">开奖号码</td>
    <!--<th colspan="6" scope="col">开奖号码公布</td>-->
    <td colspan="16" scope="col">和值</td>
    <td colspan="2" scope="col">大小</td>
    <td colspan="2" scope="col">单双</td>
  </tr>
  <tr>
    <td style="width:35px">03</td>
    <td style="width:35px">04</td>
    <td style="width:35px">05</td>
    <td style="width:35px">06</td>
    <td style="width:35px">07</td>
    <td style="width:35px">08</td>
    <td style="width:35px">09</td>
    <td style="width:35px">10</td>
    <td style="width:35px">11</td>
    <td style="width:35px">12</td>
    <td style="width:35px">13</td>
    <td style="width:35px">14</td>
    <td style="width:35px">15</td>
    <td style="width:35px">16</td>
    <td style="width:35px">17</td>
    <td style="width:35px">18</td>
    <td style="width:35px">大</td>
    <td style="width:35px">小</td>
    <td style="width:35px">单</td>
    <td style="width:35px">双</td>
  </tr>
</table>
<table id="zoushiPuture" border="0" cellpadding="0" cellspacing="0" style="text-align:center; border-bottom:1px solid #f1f1f1; border-right:1px solid #f1f1f1;"></table>
<div id="canvasBox1"></div>
<div id="canvasBox2"></div>
<div id="canvasBox3"></div>
</div>
<script type="text/javascript">
var date = []; //随机开奖的结果集
var pointDate = []; //画图的结果集
var bigSmallDate = []; //大小的坐标结果集
var signDoubleDate = []; //单双的坐标结果集
<% if( dateList != null && dateList.~size > 0 ){ %>
	<% for(item in dateList){ %>
			date.push(formd("${item.qiNum}","${item.Num}"));
	<%}
}%>

for(var j=0;j<date.length;j++){
	var chdate = date[j].Num;
	var firstNum = chdate.substring(0,1);
	var secondNum = chdate.substring(1,2);
	var threeNum = chdate.substring(2,3);
	$("#zoushiPuture").append('<tr><td style="width:100px;">'+date[j].qiNum+'</td><td style="width:38px; background:#FFFFEE;">'+firstNum+'</td><td style="width:38px; background:#FFFFEE;">'+secondNum+'</td><td style="width:38px; background:#FFFFEE;">'+threeNum+'</td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td><td style="width:35px;"></td></tr>');

	//写开奖号码公布
    var tdArr = $("#zoushiPuture").find("tr").eq(j).find("td");
    /*tdArr.eq(writNum(firstNum)).text(firstNum);
    tdArr.eq(writNum(secondNum)).text(secondNum);
	tdArr.eq(writNum(threeNum)).text(threeNum);*/
	
	//写和值
	var allRes = parseInt(firstNum)+parseInt(secondNum)+parseInt(threeNum);
    tdArr.eq(writResult(allRes)).text(allRes);
    tdArr.eq(writResult(allRes)).css({"background":"#3E94F1","color":"#fff"});
	
	//整理画和值的线的坐标
	var helfHeight = parseInt(tdArr.eq(writResult(allRes)).height())/2;
	var helfWidth = parseInt(tdArr.eq(writResult(allRes)).width())/2;
	var Y = parseInt(tdArr.eq(writResult(allRes)).offset().top)+helfWidth; 
	var X = parseInt(tdArr.eq(writResult(allRes)).offset().left)+helfHeight; 
	pointDate.push(formPointer(X,Y));
	
	//整理画(大小)的线的坐标
	/*var bsHeight = parseInt(tdArr.eq(bigsamll(allRes)).height())/2;
	var bsWidth = parseInt(tdArr.eq(bigsamll(allRes)).width())/2;
	var bsY = parseInt(tdArr.eq(bigsamll(allRes)).offset().top)+bsWidth; 
	var bsX = parseInt(tdArr.eq(bigsamll(allRes)).offset().left)+bsHeight; 
	bigSmallDate.push(formPointer(bsX,bsY));*/
	
	//整理画(单双)的线的坐标
	/*var dsHeight = parseInt(tdArr.eq(signDouble(allRes)).height())/2;
	var dsWidth = parseInt(tdArr.eq(signDouble(allRes)).width())/2;
	var dsY = parseInt(tdArr.eq(signDouble(allRes)).offset().top)+dsWidth; 
	var dsX = parseInt(tdArr.eq(signDouble(allRes)).offset().left)+dsHeight; 
	signDoubleDate.push(formPointer(dsX,dsY));*/
	
	//写大小
	if(allRes<=10){
		tdArr.eq(21).text("小");
		tdArr.eq(21).css({"background":"#5CD38F","color":"#fff"});
	}else if(allRes>10){
		tdArr.eq(20).text("大");
		tdArr.eq(20).css({"background":"#5CD38F","color":"#fff"});
	}
	
	//写单双
	if(allRes%2==0){
		tdArr.eq(23).text("双");
		tdArr.eq(23).css({"background":"#FF9C00","color":"#fff"});
	}else{
		tdArr.eq(22).text("单");
		tdArr.eq(22).css({"background":"#FF9C00","color":"#fff"});
	}
}

$(function(){
	for(var i=1; i<pointDate.length; i++){
		var top1 = pointDate[i-1].y;//起点的y坐标
		var left1 = pointDate[i-1].x;//终点的x坐标
		var top2 = pointDate[i].y;//终点的y坐标
		var left2 = pointDate[i].x;//终点的x坐标
		drawLine2(left1,top1,left2,top2,(i-1),1);
	}
})

function formd(qiNum, Num){
	var jsond = {};
	jsond.qiNum = qiNum;
	jsond.Num = Num;
	return jsond;
}

function bigsamll(allRes){
	if(allRes<=10){
		return 21;
	}else if(allRes>10){
		return 20;
	}
}

function signDouble(allRes){
	if(allRes%2==0){
		return 23;
	}else{
		return 22;
	}
}

function writResult(allRes){
	if(allRes==3||allRes=="3"){
		return 4;
	}else if(allRes==4||allRes=="4"){
		return 5;
	}else if(allRes==5||allRes=="5"){
		return 6;
	}else if(allRes==6||allRes=="6"){
		return 7;
	}else if(allRes==7||allRes=="7"){
		return 8;
	}else if(allRes==8||allRes=="8"){
		return 9;
	}else if(allRes==9||allRes=="9"){
		return 10;
	}else if(allRes==10||allRes=="10"){
		return 11;
	}else if(allRes==11||allRes=="11"){
		return 12;
	}else if(allRes==12||allRes=="12"){
		return 13;
	}else if(allRes==13||allRes=="13"){
		return 14;
	}else if(allRes==14||allRes=="14"){
		return 15;
	}else if(allRes==15||allRes=="15"){
		return 16;
	}else if(allRes==16||allRes=="16"){
		return 17;
	}else if(allRes==17||allRes=="17"){
		return 18;
	}else if(allRes==18||allRes=="18"){
		return 19;
	}
}

function formPointer(x,y){
	var jsond = {};
	jsond.x = x;
	jsond.y = y;
	return jsond;
}

//封装一个画线的方法
function drawLine2(x1,y1,x2,y2,index,objNum){
	var top = 0;
	var left = 0;
	var width = 0;
	var height = 0;
	var starPoint1 = 0;
	var overPoint1 = 0;
	var starPoint2 = 0;
	var overPoint2 = 0;
	if(x2>x1){
		top=y1;
		left=x1;
		width = x2-x1;
		height = y2 - y1;
		starPoint1 = 0;
		overPoint1 = 0;
		starPoint2 = width;
		overPoint2 = height;
	}else{
		top=y1;
		left=x2;
		width = x1-x2;
		height = y2 - y1;
		starPoint1 = width;
		overPoint1 = 0;
		starPoint2 = 0;
		overPoint2 = height;
	}
	//console.log(x1+","+y1+"/"+x2+","+y2+"/"+index);
	var cava = '<canvas width="'+(width+2)+'" height="'+height+'" style="position: absolute; top: '+top+'px; left: '+left+'px;"></canvas>'
	$("#canvasBox"+objNum).append(cava);
	
	var canvas=$("#canvasBox"+objNum+" canvas")[index];
	var ctx=canvas.getContext('2d');
	ctx.beginPath();
	ctx.moveTo(starPoint1,overPoint1);
	ctx.lineTo(starPoint2,overPoint2);
	ctx.strokeStyle = "#3E94F1";
	ctx.stroke();
}
</script>
</body>
</html>
